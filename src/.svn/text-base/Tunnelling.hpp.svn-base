#ifndef INC_TUNNELING_hpp
#define INC_TUNNELING_hpp

#ifdef __SUNPRO_CC
#include <stdio.h>
#else
#include <cstdio>
#endif

#include "Structure_Element.hpp"
#include "PseudoRandomNumberGenerator.hpp"

double Ionization_Rate_Tunnelling_SI(double Ip,    double E,    int Z, int l, int m);
double Ionization_Rate_Tunnelling_au(double Ip_au, double E_au, int Z, int l, int m);

// FIXME: this is probably bad. Don't use unsigned long int cast for pointers...
// Macro to get the pointer to the right element (efld or fefld)
// #define E(p,o) ((double *)(((unsigned long int)p) + o))

int Ionization_Tunnelling(void *al, void *el, const double time, const double dt,
                           const int &Nb_atoms, const int &Nb_atoms_max,
                           int &Nb_electrons, const int &Nb_electrons_max,
                           unsigned long int &index_next_empty_space,
                           const elem_props &element, const int E_offset,
                           const double omega, bool &did_ionization_occur,
                           int *ionizedlist, Lib_PRNG &prng,
                           FILE *fh_out = NULL);

#endif // INC_TUNNELING_hpp

// ********** End of file ***************************************
